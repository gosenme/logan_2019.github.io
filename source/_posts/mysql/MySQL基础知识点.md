---
title: MySQL基础知识点
---

### 事务的原理
- 事务是数据库并发控制的基本单位
- 事务可以看作是一系列SQL语句的集合
- 事务要么全部执行成功，要么全部执行失败(回滚)

### 事务的特性(ACID)
- A `原子性` 一个事务中所有操作全部完成或失败
- C `一致性` 事务开始和结束之后数据完整性没有被破坏
- I `隔离性` 允许多个事务同时对数据库修改和读写
- D `持久性` 事务结束之后，修改是永久的不会丢失

### 不对事务进行并发控制可能产生哪些问题
- `幻读` 一个事务第二次查出现第一次没有的结果
- `非重复读` 一个事务重复读两次得到不同结果
- `脏读` 一个事务读取到另一个事务没有提交的修改
- `丢失修改` 并发写入造成其中一些修改丢失

### 为了解决并发异常控制，定义了4种事务隔离级别
- `读未提交` 别的事务可以读取到未提交的改变
- `读已提交` 只能读取已经提交的数据
- `可重复读` 同一个事务先后查询结果一样(MySQL InnoDB默认实现可重复读级别)
- `串行化` 事务完全串行化的执行，隔离级别最高，执行效率最低(通过锁严格使事务按顺序执行)

### 如何解决高并发场景下的插入重复(写入数据库会有数据重复问题)
- 使用数据库唯一索引
- 使用队列异步写入(在涉及到大量数据时，可能要做分库分表，此时唯一索引不适用)
- 使用redis实现分布式锁(插入时加锁，完成后释放锁)

### 悲观锁和乐观锁
- `悲观锁` 先获取锁再进行操作。一锁二查三更新(select for update)
- `乐观锁` 先修改，更新的时候发现数据已经变了就回滚(check and set)，一般通过版本号或时间戳实现
- 锁类型的选择需要根据响应速度、冲突频率、重试代价来判断使用哪一种

### MySQL的数据类型
- 文本类 CHAR VARCHAR TINYTEXT TEXT
- 数值类 INT FLOAT DOUBLE BIGINT TINYINT SMALLINT MEDIUMINT
- 日期和时间 DATE DATETIME TIMESTAMP

### MySQL引擎 InnoDB和MyISAM
- MyISAM不支持事务，InnoDB支持事务
- MyISAM不支持外键，InnoDB支持外键
- MyISAM只支持表锁，InnoDB支持行锁和表锁
- MyISAM支持全文索引，InnoDB不支持全文索引